"use strict";!function(t,e,i){var s=this,a=(t.console.log,[]),o={},r=void 0,n=void 0,c=function(t){t.matches?l.each(a,function(e){e.hasMediaQueries()&&(r&&clearTimeout(r),n&&clearTimeout(n),r=setTimeout(function(){e.changeMedia(t.media),r=null,n=null},10))}):r||(n&&clearTimeout(n),n=setTimeout(function(){l.each(a,function(t){t.hasMediaQueries()&&t.changeMedia()}),r=null,n=null},10))},h="ontouchstart"in t||i.maxTouchPoints>0||i.msMaxTouchPoints>0,l={getByClass:function(t,e,i){var s=t.getElementsByClassName(e);return i&&s.length?s[0]:s.length&&s||void 0},getByTag:function(t,e,i){var s=t.getElementsByTagName(e);return i&&s&&s.length?s[0]:s},mkel:function(t,i){var s=e.createElement(t);if(i)for(var a=Object.keys(i),o=0;o<a.length;o++)s.setAttribute(a[o],i[a[o]]);return s},each:function(t,e){for(var i=void 0,a=0;a<t.length&&(i=e.call(s,t[a]),i!==!1);a++);},addMediaQuery:function(e){o[e]||(o[e]=!0,t.matchMedia(e).addListener(c))},setPercentTouchThreshold:function(e,i){var s=t.outerWidth,a=Math.abs(Math.round(s/(100/e)));i.touchthreshold=a}},u=function t(e){var i=this;this.config={delay:8e3,transition:"slide",touchthreshold:80,swipeRubberBand:1};var s=e.dataset,o=this.config;a.push(this),this.element=e,this.useIndicators=void 0!==s.carouselIndicators,this.indicators=[],this.slider=l.getByClass(e,"carousel-slider",!0),this.items=[],this.ivalId=null,this.currPos=0,this._hasmedia=-1,this._percentTouchThreshold=0,this.staticTextElem=l.getByClass(e,"carousel-static-text",!0),h&&this.element.classList.add("carousel-is-touch");var r=l.getByClass(this.slider,"carousel-item"),n=0,c=void 0;l.each(r,function(e){i.items.push(new t.Item(e,(n++),i))}),s.carouselDelay&&(o.delay=parseInt(s.carouselDelay,10)),s.carouselTransition&&(o.transition=s.carouselTransition),h&&s.carouselTouchThreshold&&(c=s.carouselTouchThreshold,"%"===c[c.length-1]?(this._percentTouchThreshold=parseInt(c,10),l.setPercentTouchThreshold(this._percentTouchThreshold,o)):o.touchthreshold=parseInt(c,10)),s.carouselRubberbandSwipe&&(c=parseFloat(s.carouselRubberbandSwipe,10),c>1&&(o.swipeRubberBand=c)),this.items.length&&(this.items[0].load(),this.items[0].activate()),this.items.length>1&&(this.items[1].load(),this._makeIndicators()),h&&this._setupTouchEvents(),this.items.length>1&&this.play()};u.prototype.sliderAnimate=function(t){t?this.slider.classList.add("animate"):this.slider.classList.remove("animate")},u.prototype.play=function(){this.ivalId&&clearTimeout(this.ivalId);var t=this;this.ivalId=setTimeout(function(){t.next(),t.play()},this.config.delay)},u.prototype.pause=function(){clearTimeout(this.ivalId),this.sliderAnimate(!1)},u.prototype.next=function(){this.currPos+=1,this.currPos>=this.items.length&&(this.currPos=0),this.goto(this.currPos)},u.prototype.goto=function(t){t<0?t=this.items.length-1:t>=this.items.length&&(t=0);var e=t<this.currPos?t-1:t+1;clearTimeout(this.ivalId),this.sliderAnimate(!0),this._loadIfNecessary(t),this._loadIfNecessary(e),this.setIndicator(t),this.slider.dataset.carouselPos=t,this.currPos=t,this.items[t].activate(),this.play()},u.prototype.hasMediaQueries=function(){var t=this;return this._hasmedia!==-1?!!this._hasmedia:(l.each(this.items,function(e){if(e.hasMediaQueries)return t._hasmedia=1,!1}),this._hasmedia===-1&&(this._hasmedia=0),!!this._hasmedia)},u.prototype.changeMedia=function(t){this._percentTouchThreshold&&l.setPercentTouchThreshold(this._percentTouchThreshold,this.config),l.each(this.items,function(e){e.hasMediaQueries&&e.changeMedia(t)})},u.prototype._loadIfNecessary=function(t){t>=0&&t<this.items.length&&(this.items[t].isLoaded||this.items[t].load())},u.prototype._setupTouchEvents=function(){var t=this,e={x:0,y:0,startX:0},i=this,s=function(t){return t.changedTouches[0]},a=function(t){e.x=t.clientX,e.y=t.clientY,e.startX=t.clientX},o=this.slider,r=!1,n=void 0;o.addEventListener("touchstart",function(e){n&&clearTimeout(n);var o=s(e);a(o),t.element.classList.add("carousel-is-touchdrag"),i.pause()},!1),o.addEventListener("touchend",function(t){if(n=setTimeout(function(){i.element.classList.remove("carousel-is-touchdrag")},1e3),r)return void(r=!1);var a=s(t),c=a.clientX-e.x;Math.abs(c)<i.config.touchthreshold&&(i.sliderAnimate(!0),requestAnimationFrame(function(){o.style.removeProperty("left")})),i.play()},!1),o.addEventListener("touchcancel",function(){i.element.classList.remove("carousel-is-touchdrag"),o.style.removeProperty("left"),i.play()},!1);var c=function t(n){var c=s(n),l=c.clientX-e.x,u=c.clientX-e.startX,d=o.offsetLeft;e.x=c.clientX;var m=d+l/(i.config.swipeRubberBand||1);return Math.abs(u)>i.config.touchthreshold?(n.preventDefault(),r=!0,o.style.removeProperty("left"),o.removeEventListener("touchmove",t,!1),l>0?(i._loadIfNecessary(i.currPos-1),i.goto(i.currPos-1)):l<0&&(i._loadIfNecessary(i.currPos+1),i.goto(i.currPos+1)),setTimeout(function(){a(c),h()},600),!1):void(o.style.left=m+"px")},h=function(){o.addEventListener("touchmove",c,!1)};h()},u.prototype._makeIndicators=function(){var t=this;if(this.useIndicators&&!(this.items.length<2)){var e=l.getByClass(this.element,"carousel-indicators",!0),i=[];e||(e=l.mkel("div",{class:"carousel-indicators"})),this.items.forEach(function(){var s=new u.Indicator(t,i.length);e.appendChild(s.btn),i.push(s)}),i[0].activate(),this.element.appendChild(e),this.indicators=i}},u.prototype.setIndicator=function(t){!this.useIndicators||this.items.length<2||(void 0===t&&(t=this.currPos),this.currPos=t,this.indicators.forEach(function(t){t.deActivate()}),this.indicators[t].activate())},u.clickBack=null,u.Item=function(i,s,a){var o=this;if(this.mediaQueries={},this.hasMediaQueries=!1,this.img=l.getByTag(i,"img",!0),this.element=i,this.isLoaded=!1,this.src=null,this.mediaSizes=null,this.href=i.dataset.carouselHref,this.position=s,this.hasImg=void 0===this.img.length,this.carousel=a,this.element.setAttribute("data-carousel-position",s),this.href&&i.addEventListener("click",function(t){if(t.preventDefault(),"function"==typeof u.clickBack){var i=u.clickBack(o);if(i===!1)return}e.location.href=o.href},!0),this.hasImg){this.defaultSrc=this.img.dataset.carouselSrc,this._collectMediaSizes();for(var r=Object.keys(this.mediaQueries).sort(),n=void 0,c=0;c<r.length;c++)n=r[c],t.matchMedia(n).matches&&(this.src=this.mediaQueries[n]);this.src||(this.src=this.img.dataset.carouselSrc),this.img.style.display="none"}},u.Item.prototype.activate=function(){var t=this,i=this.carousel.staticTextElem;if(i){var s=function(){e.location.href=t.href};i._cb&&i.removeEventListener("click",i._cb),this.href?(i.addEventListener("click",s,!1),i._cb=s,i.style.cursor="pointer"):i.style.cursor="default"}},u.Item.prototype.changeMedia=function(t){var e=this.mediaQueries[t];this.src=e||this.defaultSrc,this.isLoaded&&this.load()},u.Item.prototype._collectMediaSizes=function(){var t=void 0,e=[],i={};for(var s in this.img.dataset)t=s.match(/Mq-(\d+)$/),t&&(this.hasMediaQueries=!0,t=parseInt(t[1]),e.push(t),i[t]=this.img.dataset[s]);var a=e.length;if(a){var o=void 0,r=void 0;e.sort();for(var n=0;n<a;n++)o=e[n],r="(min-width: "+(o+1)+"px)",this.mediaQueries[r]=i[o],l.addMediaQuery(r);this.mediaSizes=e}},u.Item.prototype.load=function(){this.hasImg&&this._setSrc(this.src)},u.Item.prototype._setSrc=function(t){var e=this;this.hasImg&&(this.img.setAttribute("src",t),this.img.onload=function(){e.element.style.backgroundImage="url("+t+")",e.isLoaded=!0})},u.Indicator=function(t,e){var i=this;this.index=e,this.owner=t,this.btn=l.mkel("a",{class:"carousel-indicator",href:"#carousel-"+e}),this.btn.appendChild(l.mkel("span",{class:"carousel-indicator-inner"})),this.btn.addEventListener("click",function(t){return t.preventDefault(),i.owner.goto(i.index),!1},!0)},u.Indicator.prototype.activate=function(){this.btn.classList.add("carousel-indicator-active")},u.Indicator.prototype.deActivate=function(){this.btn.classList.remove("carousel-indicator-active")},t.addEventListener("DOMContentLoaded",function(){var t=l.getByClass(e,"carousel");t&&t.length&&l.each(t,function(t){new u(t)})}),t.Carousel=u}(window,document,window.navigator);
//# sourceMappingURL=carousel.min.js.map
